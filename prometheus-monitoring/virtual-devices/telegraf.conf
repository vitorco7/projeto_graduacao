# Global Agent Configuration
[agent]
  interval = "30s"
  round_interval = true
  metric_batch_size = 500  # Reduced from 1000
  metric_buffer_limit = 5000  # Reduced from 10000
  collection_jitter = "5s"  # Added jitter
  flush_interval = "30s"
  flush_jitter = "5s"  # Added jitter
  precision = ""
  debug = true  # Enable debug logging
  quiet = false
  logtarget = "stderr"
  hostname = ""
  omit_hostname = false

# Prometheus-compatible output with retry logic
[[outputs.prometheus_client]]
  listen = ":9273"
  path = "/metrics"
  expiration_interval = "120s"  # Increased from 60s
  metric_version = 2
  
[[inputs.cgroup]]
  name_prefix = "container_"  
  paths = ["/sys/fs/cgroup/"]

  files = [
    "cpu.stat",
    "memory.max",
    "memory.current",
    "memory.swap.max",
    "memory.swap.current",
    "io.stat",
    "cpu.pressure",
    "io.pressure"
  ]
  fieldinclude = [ "*user_usec*", "*system_usec*",  "memory.current",  "memory.max",  "memory.swap.current",  "memory.swap.max", "*rbytes*", "*wbytes*", "*cpu.pressure*", "*io.pressure*"]